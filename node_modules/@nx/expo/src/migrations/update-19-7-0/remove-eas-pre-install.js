"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = update;
const devkit_1 = require("@nx/devkit");
const path_1 = require("path");
/**
 * Remove eas-build-pre-install script from app's package.json.
 * This script causes an issue with Yarn 4.
 */
function update(tree) {
    const projects = (0, devkit_1.getProjects)(tree);
    for (const [_, config] of projects.entries()) {
        const packageJsonPath = (0, path_1.join)(config.root, 'package.json');
        if (!tree.exists(packageJsonPath)) {
            continue;
        }
        (0, devkit_1.updateJson)(tree, (0, path_1.join)(config.root, 'package.json'), (packageJson) => {
            if (packageJson.scripts?.['eas-build-pre-install']) {
                delete packageJson.scripts['eas-build-pre-install'];
            }
            return packageJson;
        });
    }
}
